var url=location.href;function slideShow(){var e=$("#slajder .vidljiv"),a=e.next().length?$(".vidljiv").next():e.parent().children(":first");e.removeClass("vidljiv").addClass("nevidljiv"),a.addClass("vidljiv").removeClass("nevidljiv")}function slajder(){setInterval(function(){slideShow()},1e4);var e=$(".strelicaDesno"),a=$(".strelicaLevo");e.click(function(){slideShow()}),a.click(function(){var e=$("#slajder .vidljiv"),a=e.prev().length?$(".vidljiv").prev():e.parent().children(":last");e.removeClass("vidljiv").addClass("nevidljiv"),a.addClass("vidljiv").removeClass("nevidljiv")})}function podMeni(){$("#bars").click(function(){$("#podMeni").slideToggle(),$("#bars").toggleClass("MeniBar")})}function prikazNajnovijih(e){$.ajax({url:"proizvodi/najnoviji.php",method:"GET",dataType:"json",success:function(a){let i,t="";i=e?"dodajUKorpu":"disable",a.forEach(e=>{t+=`\n                    <div class='col-lg-2 col-sm-5 col-10  flex2 proizvod'>\n                        <img src='images/proizvodi/${e.putanja}' alt='${e.opis}' class='slikaProizvod'>\n                        <h3>${e.nazivMarka} ${e.naziv}</h3>\n                        ${specifikacije(e.specifikacije)}\n                        <p class='naStanju'> Na stanju</p>\n                        <h4 class='cena'>${cena(e.cena)} RSD</h4>\n                        <div class='flex4'>\n                            <a href='proizvod.php?id=${e.idProizvod}' class='detaljnije'>Detaljnije</a>\n                            <a href='#' class='${i}' data-id='${e.idProizvod}'><i class='fas fa-shopping-cart'></i> Kupi</a>\n                        </div>\n                    </div>`}),document.getElementById("sadrzaj").innerHTML=t,e||$("#sadrzaj .disable").on("click",function(e){e.preventDefault(),alert("Morate se registrovati")}),$(".dodajUKorpu").click(dodajUKorpu)},error:function(e,a,i){alert(e.status+" "+a)}})}function specifikacije(e){let a="<ul>";return e.forEach(e=>{a+=`<li>${e.nazivKarakteristika}: ${e.vrednost}</li>`}),a+="</ul>"}function cena(e){return e=e.substr(0,e.length-3).replace(/\B(?=(\d{3})+(?!\d))/g,".")}function registracija(){let e=!0,a=$("#posalji").val(),i=$("#ime"),t=$("#prezime"),o=$("#email"),n=$("#emailPotvrda"),r=$("#lozinka"),s=$("#lozinkaPotvrda"),l=$("#adresa"),d=$("#grad"),p=$("#telefon"),c=$("#postanskiBroj");/^[A-Z][a-z]{2,19}$/.test(i.val())?i.next().hide():(i.next().show(),e=!1),/^[A-Z][a-z]{2,19}(\s[A-Z][a-z]{2,19})*$/.test(t.val())?t.next().hide():(t.next().show(),e=!1),/^[^@]+@[^@]+\.[^@\.]+$/.test(o.val())?o.next().hide():(o.next().show(),e=!1),o.val()!=n.val()?(n.next().show(),e=!1):n.next().hide(),/^06\d{7,8}$/.test(p.val())?p.next().hide():(p.next().show(),e=!1),!/^\w+(\s\w+)*$/.test(l.val())||l.val().length>100?(l.next().show(),e=!1):l.next().hide(),/^[A-Z][a-z]{1,15}(\s[A-Z][a-z]{1,15})*$/.test(d.val())?d.next().hide():(d.next().show(),e=!1),/^\d{4,10}$/.test(c.val())?c.next().hide():(c.next().show(),e=!1),r.val().length<6?(r.next().show(),e=!1):r.next().hide(),r.val()!=s.val()?(s.next().show(),e=!1):s.next().hide(),e&&(i=i.val(),t=t.val(),o=o.val(),r=r.val(),l=l.val(),d=d.val(),p=p.val(),c=c.val(),$.ajax({url:"korisnik/registracija.php",method:"post",dataType:"json",data:{btn:a,ime:i,prezime:t,email:o,lozinka:r,adresa:l,grad:d,telefon:p,postanskiBroj:c},success:function(e){let a="";e.forEach(e=>{a+=`<span>${e}</span><br/>`}),document.getElementById("poruka").innerHTML=a},error:function(e,a,i){let t="";e.responseJSON.forEach(e=>{t+=`<span>${e}</span><br/>`}),document.getElementById("poruka").innerHTML=t}}))}function logovanje(){let e=!0,a=$("#posalji").val(),i=$("#email"),t=$("#lozinka");/^[^@]+@[^@]+\.[^@\.]+$/.test(i.val())?i.next().hide():(i.next().show(),e=!1),t.val().length<6?(t.next().show(),e=!1):t.next().hide(),e&&(i=i.val(),t=t.val(),$.ajax({url:"korisnik/logovanje.php",method:"post",dataType:"json",data:{btn:a,email:i,lozinka:t},success:function(e){window.location.href="index.php"},error:function(e,a,i){let t="";e.responseJSON.forEach(e=>{t+=`<span>${e}</span><br/>`}),document.getElementById("poruka").innerHTML=t}}))}function sviProizvodi(e){$.ajax({url:"proizvodi/sviProizvodi.php",method:"GET",success:e})}function prikaziProizvode(e,a){let i,t="";i=a?"dodajUKorpu":"disable",e.proizvodi.forEach(e=>{t+=`\n            <div class='col-lg-3 col-md-5 col-8  flex2 proizvod'>\n                <img src='images/proizvodi/${e.putanja}' alt='${e.opis}' class='slikaProizvod'>\n                <h3>${e.nazivMarka} ${e.naziv}</h3>\n                ${specifikacije(e.specifikacije)}\n                <p class='naStanju'> Na stanju</p>\n                <h4 class='cena'>${cena(e.cena)} RSD</h4>\n                <div class='flex4'>\n                    <a href='proizvod.php?id=${e.idProizvod}' class='detaljnije'>Detaljnije</a>\n                    <a href='#' class='${i}' data-id='${e.idProizvod}'><i class='fas fa-shopping-cart'></i> Kupi</a>\n                </div>\n            </div>`}),document.getElementById("sadrzajProizvodi").innerHTML=t,a||$("#sadrzajProizvodi .disable").on("click",function(e){e.preventDefault(),alert("Morate se registrovati")}),$(".dodajUKorpu").click(dodajUKorpu)}function dodajUKorpu(e){e.preventDefault();let a=$(this).data("id"),i=[];localStorage.getItem("kupljenProizvod")?(i=JSON.parse(localStorage.getItem("kupljenProizvod"))).filter(e=>e.id==a).length?(i.forEach(e=>{e.id==a&&e.kolicina++}),upisiULocalStorage("kupljenProizvod",i)):(i.push({id:a,kolicina:1}),upisiULocalStorage("kupljenProizvod",i)):(i[0]={id:a,kolicina:1},upisiULocalStorage("kupljenProizvod",i)),brojProizvodaUKorpi()}function upisiULocalStorage(e,a){localStorage&&localStorage.setItem(e,JSON.stringify(a))}function brojProizvodaUKorpi(){if(localStorage.getItem("kupljenProizvod")){let e=JSON.parse(localStorage.getItem("kupljenProizvod"));if(e.length){let a=0;e.forEach(e=>{a+=e.kolicina}),$("#header .broj").text(a).css("display","flex")}else $("#header .broj").hide()}else $("#header .broj").hide()}function korpa(){let e="<div class='prazno flex'><h1>Vaša korpa je prazna <i class='fas fa-shopping-cart'></i></h1></div>",a=0;localStorage.getItem("kupljenProizvod")?$.ajax({url:"proizvodi/proizvodiKorpa.php",method:"get",dataType:"json",success:function(i){let t=JSON.parse(localStorage.getItem("kupljenProizvod"));console.log(i);let o=i.filter(e=>{for(let a=0;a<t.length;a++)if(t[a].id==e.idProizvod)return e.kolicina=t[a].kolicina,!0});if(console.log(o),o.length){let e='\n                <table id="tabela">\n                    <tr>\n                        <th>Slika</th>\n                        <th>Naziv</th>\n                        <th>Cena</th>\n                        <th>Količina</th>\n                        <th>Ukupna cena</th>\n                        <th>Ukloni</th>\n                    </tr>';o.forEach(i=>{e+=`<tr>\n                        <td><img class="thumbnail" src="images/proizvodi/thumbnail/${i.putanja}" alt="${i.opis}"/></td>\n                        <td>${i.nazivMarka} ${i.naziv}</td>\n                        <td>${cena(i.cena)} RSD</td>\n                        <td>${i.kolicina}</td>\n                        <td>${iznos(cena(i.cena),i.kolicina)} RSD</td>\n                        <td><a href="#" data-id="${i.idProizvod}">Ukloni</a></td>\n                    </tr>`,a+=parseInt(zbir(iznos(cena(i.cena),i.kolicina)))}),e+=`</table>\n                <div class="red2"><h4>Ukupna cena: </h4> <p id="ukupnaCena"> ${a.toString().replace(/\./g,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")} RSD</p></div>\n                `,document.getElementById("proizvodi").innerHTML=e,$("#tabela a").click(function(e){let a=$(this).data("id");e.preventDefault(),upisiULocalStorage("kupljenProizvod",JSON.parse(localStorage.getItem("kupljenProizvod")).filter(e=>e.id!=a)),korpa(),brojProizvodaUKorpi()})}else document.getElementById("proizvodi").innerHTML=e,$("#nastaviKupovinu").hide()},error:function(e){console.error(e)}}):document.getElementById("proizvodi").innerHTML=e}function porudzbina(e){let a=JSON.parse(localStorage.getItem("kupljenProizvod"));$.ajax({url:"korisnik/porudzbina.php",method:"post",dataType:"json",data:{proizvodi:a,id:e},success:function(e){console.log(e),document.getElementById("proizvodi").innerHTML=`<div class='prazno flex'><h1>${e}<i class='fas fa-truck'></i></h1></div>`,$("#nastaviKupovinu").hide(),localStorage.removeItem("kupljenProizvod"),brojProizvodaUKorpi()},error:function(e,a,i){console.log(e),document.getElementById("proizvodi").innerHTML=`<div class='prazno flex'><h1>${e.responseJSON}<i class='fas fa-truck'></i></h1></div>`,$("#nastaviKupovinu").hide(),localStorage.removeItem("kupljenProizvod"),brojProizvodaUKorpi()}})}function iznos(e,a){let i=e.replace(/(\.)/g,"")*a;return i=i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")}function zbir(e){return e.replace(/(\.)/g,"")}function prikaziFilter(){$(".prikazi").click(function(){$(this).find("i").toggleClass("fas fa-angle-down"),$(this).find("i").toggleClass("fas fa-angle-up"),$(this).next().stop(!0,!0).slideToggle("slow")})}function prikazCheckbox(){$.ajax({url:"proizvodi/marke.php",method:"post",dataType:"json",success:function(e){let a="";e.forEach(e=>{a+=`<span><input type="checkbox" name="filtriranjePoMarci" value="${e.idMarka}">\n                <label>${e.nazivMarka}</label></span>`}),$(".divRobneMarke").html(a),prikaziFilter(),$("input[name=filtriranjePoMarci]").change(filtriranjePoMarci)},error:function(e,a,i){console.log(e)}})}window.onload=function(){podMeni(),brojProizvodaUKorpi()},-1!=url.indexOf("index.php")&&(slajder(),prikazNajnovijih(!1),$("#posalji").click(provera),prikaziAnketu(),$("#rezultati").click(prikaziRezAnkete),$("#kontakt .disable").click(function(){alert("Morate se registrovati")}),$("#kontakt .disableGlasao").click(function(){alert("Već ste odgovorili na ovu anketu")}),$("#glasaj").click(upisOdgovora)),-1!=url.indexOf("registracija.php")&&document.getElementById("posalji").addEventListener("click",registracija),-1!=url.indexOf("login.php")&&document.getElementById("posalji").addEventListener("click",logovanje),-1!=url.indexOf("proizvodi-korisnik.php")&&(sviProizvodi(function(e){prikaziProizvode(e,!1),paginacija(e.brojStranica)}),prikazCheckbox(),$("#sortiraj").change(sortiranje),$("#pretraga").click(search)),-1!=url.indexOf("korpa-korisnik.php")&&korpa(),-1!=url.indexOf("proizvod.php")&&($("#proizvod .disable").on("click",function(e){e.preventDefault(),alert("Morate se registrovati")}),$(".dodajUKorpu").click(dodajUKorpu)),-1!=url.indexOf("proizvod-update-insert.php?uradi=update")&&$("#posalji").click(function(){insertupdateProizvod("update","izmenili")}),-1!=url.indexOf("proizvod-update-insert.php?uradi=insert")&&$("#posalji").click(function(){insertupdateProizvod("insert","dodali")}),-1!=url.indexOf("korisnici-admin.php")&&$("#posalji").click(updateKorisnik),-1!=url.indexOf("anketa-admin.php")&&($("#unesi").click(anketaInsert),$("#aktiviraj").click(aktivirajAnketu),$("#prikazi").click(prikaziRezAnkete)),$("#nastaviKupovinu").show().click(function(e){e.preventDefault(),porudzbina($(this).data("id"))});var nizMarki=[];function filtriranjePoMarci(){document.getElementById("search").value="";let e=this.value;nizMarki.includes(e)?nizMarki=nizMarki.filter(a=>a!=e):nizMarki.push(e),$.ajax({url:"proizvodi/sviProizvodi.php",method:"post",dataType:"json",data:{page:1,katNiz:nizMarki,sort:$("#sortiraj").val(),search:$("#search").val()},success:function(e){let a;prikaziProizvode(e,a=0!=$("#sadrzajProizvodi .dodajUKorpu").length),paginacija(e.brojStranica)}})}function sortiranje(){document.getElementById("search").value="";let e=this.value;console.log(e),$.ajax({url:"proizvodi/sviProizvodi.php",method:"post",dataType:"json",data:{page:1,katNiz:nizMarki,sort:e,search:$("#search").val()},success:function(e){let a;prikaziProizvode(e,a=0!=$("#sadrzajProizvodi .dodajUKorpu").length),paginacija(e.brojStranica)}})}function search(){let e=$("#search").val();console.log(e),$.ajax({url:"proizvodi/sviProizvodi.php",method:"post",dataType:"json",data:{page:1,katNiz:nizMarki,sort:$("#sortiraj").val(),search:e},success:function(e){let a;prikaziProizvode(e,a=0!=$("#sadrzajProizvodi .dodajUKorpu").length),paginacija(e.brojStranica),0==e.proizvodi.length&&(ispis="<div class='prazno flex'> <h1>Vaša pretraga nije dala rezultate. <i class='fas fa-search'></i></h1> </div>",document.getElementById("sadrzajProizvodi").innerHTML=ispis)},error:function(e,a,i){ispis="<div class='prazno flex'> <h1>Vaša pretraga nije dala rezultate. <i class='fas fa-search'></i></h1> </div>",document.getElementById("sadrzajProizvodi").innerHTML=ispis}})}function paginacija(e){let a="<ul>";for(let i=1;i<=e;i++)a+=1==i?`<li><a href="#" class="flex3 page aktivan" data-page="${i}">${i}</a></li>`:`<li><a href="#" class="flex3 page" data-page="${i}">${i}</a></li>`;a+="</ul>",document.getElementById("paginacija").innerHTML=a,$("#paginacija .page").click(function(){let e=$(this).data("page");$("#paginacija .aktivan").removeClass("aktivan"),$(this).addClass("aktivan"),$.ajax({url:"proizvodi/sviProizvodi.php",method:"post",dataType:"json",data:{page:e,katNiz:nizMarki,sort:$("#sortiraj").val(),search:$("#search").val()},success:function(e){let a;prikaziProizvode(e,a=0!=$("#sadrzajProizvodi .dodajUKorpu").length)}})})}function insertupdateProizvod(e,a){let i=$("#posalji").val(),t=$("#naziv").val(),o=$("#datumPost").val(),n=$("#cena").val(),r=$("#marka").val(),s=$("#spec0").val(),l=$("#spec1").val(),d=$("#spec2").val(),p=$("#spec3").val(),c=$("#spec4").val(),u=$("#spec5").val(),v=$("#spec6").val(),h=$("#spec7").val(),k=$("#spec8").val(),g=$("#spec9").val(),m=$("#spec10").val(),f=!0;if(/[\w\d\s]+/.test(t)?$("#naziv").next().hide():($("#naziv").next().show(),f=!1),n<=0?($("#cena").next().show(),f=!1):$("#cena").next().hide(),/^\d([\.,]\d)?\".*$/.test(s)?$("#spec0").next().hide():($("#spec0").next().html('Pogrešan format ( <i>Morate uneti veličinu ekrana, npr. 6,4"</i> )').show(),f=!1),/^\d{1,2}\s?GB$/.test(l)?$("#spec1").next().hide():($("#spec1").next().html("Pogrešan format ( <i>Morate uneti količinu RAM memorije, npr. 6 GB</i> )").show(),f=!1),/^\d{2,3}\s?GB$/.test(d)?$("#spec2").next().hide():($("#spec2").next().html("Pogrešan format ( <i>Morate uneti količinu Interne memorije, npr. 32 GB</i> )").show(),f=!1),/^\d{1,3}\s?MP(\s?[\-\+]\s?\d{1,3}\s?MP)*\/\d{1,3}\s?MP(\s?[\-\+]\s?\d{1,3}\s?MP)*$/.test(p)?$("#spec3").next().hide():($("#spec3").next().html("Pogrešan format ( <i>Morate uneti kvalitet kamera, npr. 12 MP/8 MP</i> )").show(),f=!1),/^.*(Dual|Quad|Octa|Hexa)(\sCore|-core).*$/.test(c)?$("#spec4").next().hide():($("#spec4").next().html("Pogrešan format ( <i>Morate uneti procesor telefona, npr. Octa-core</i> )").show(),f=!1),/^(Android|iOS|EMUI)(\s?\d{1,2}([\.,]\d{1,2})?(\s?\(\w{3,12}\))?)?$/.test(u)?$("#spec5").next().hide():($("#spec5").next().html("Pogrešan format ( <i>Morate uneti operativni sistem telefona, npr. Android</i> )").show(),f=!1),/^\d{4}\s?mAh$/.test(v)?$("#spec6").next().hide():($("#spec6").next().html("Pogrešan format ( <i>Morate uneti kapacitet baterije telefona, npr. 4000 mAh</i> )").show(),f=!1),/^\d{1,3}([\.,]\d{1,2})?\s?mm(\s?[xX]\s?\d{1,3}([\.,]\d{1,2})?\s?mm){2}$/.test(h)?$("#spec7").next().hide():($("#spec7").next().html("Pogrešan format ( <i>Morate uneti dimenzije telefona, npr. 158.5 mm x 74.7 mm x 7.7 mm</i> )").show(),f=!1),/^\d{1,4}\s?g$/.test(k)?$("#spec8").next().hide():($("#spec8").next().html("Pogrešan format ( <i>Morate uneti težinu telefona u gramima, npr. 158 g</i> )").show(),f=!1),/^\d{3,4}\s?[xX]\s?\d{3,4}\s?(px|Px|PX).*$/.test(g)?$("#spec9").next().hide():($("#spec9").next().html("Pogrešan format ( <i>Morate uneti rezoluciju telefona, npr. 1080 x 2340 px</i> )").show(),f=!1),/^\w{2,14}(\s\w{2,14})*$/.test(m)?$("#spec10").next().hide():($("#spec10").next().html("Pogrešan format ( <i>Morate uneti boju telefona, npr. Crna )").show(),f=!1),f){var z=$("#slika").prop("files")[0],j=$("#thumbnail").prop("files")[0],x=JSON.stringify({1:s,2:l,3:d,4:p,5:c,6:u,7:v,8:h,9:k,10:g,11:m}),P=new FormData;P.append("slika",z),"update"==e&&P.append("id",i),"insert"==e&&P.append("insert",!0),P.append("naziv",t),P.append("datumPost",o),P.append("cena",n),P.append("marka",r),P.append("spec",x),P.append("thumbnail",j),$.ajax({url:"admin/proizvod-"+e+".php",dataType:"script",cache:!1,contentType:!1,processData:!1,data:P,type:"post",success:function(e){alert("Uspešno ste "+a+" proizvod"),$("#poruka").html("").show()},error:function(e,a,i){ispis="<ol>",JSON.parse(e.responseText).forEach(e=>{ispis+=`<li>${e}</li>`}),ispis+="</ol>",$("#poruka").html(ispis).show()}})}}function updateKorisnik(){let e=!0,a=$("#posalji").val(),i=$("#ime"),t=$("#prezime"),o=$("#email"),n=$("#lozinka"),r=$("#adresa"),s=$("#uloga").val(),l=$("#grad"),d=$("#telefon"),p=$("#postanskiBroj");/^[A-Z][a-z]{2,19}$/.test(i.val())?i.next().hide():(i.next().show(),e=!1),/^[A-Z][a-z]{2,19}(\s[A-Z][a-z]{2,19})*$/.test(t.val())?t.next().hide():(t.next().show(),e=!1),/^[^@]+@[^@]+\.[^@\.]+$/.test(o.val())?o.next().hide():(o.next().show(),e=!1),/^06\d{7,8}$/.test(d.val())?d.next().hide():(d.next().show(),e=!1),!/^\w+(\s\w+)*$/.test(r.val())||r.val().length>100?(r.next().show(),e=!1):r.next().hide(),/^[A-Z][a-z]{1,15}(\s[A-Z][a-z]{1,15})*$/.test(l.val())?l.next().hide():(l.next().show(),e=!1),/^\d{4,10}$/.test(p.val())?p.next().hide():(p.next().show(),e=!1),n.val().length<6?(n.next().show(),e=!1):n.next().hide(),e&&(i=i.val(),t=t.val(),o=o.val(),n=n.val(),r=r.val(),l=l.val(),d=d.val(),p=p.val(),$.ajax({url:"admin/korisnik-update.php",method:"post",dataType:"json",data:{btn:a,ime:i,prezime:t,email:o,lozinka:n,uloga:s,adresa:r,grad:l,telefon:d,postanskiBroj:p},success:function(e){let a="";e.forEach(e=>{a+=`<span>${e}</span><br/>`}),document.getElementById("poruka").innerHTML=a},error:function(e,a,i){let t="";e.responseJSON.forEach(e=>{t+=`<span>${e}</span><br/>`}),document.getElementById("poruka").innerHTML=t}}))}function provera(){let e=document.getElementById("posalji").value,a=document.getElementById("ime").value,i=document.getElementById("prezime").value,t=document.getElementById("email").value,o=document.getElementById("telefon").value,n=document.getElementById("porukaForma").value,r=document.getElementById("razlogKontakta").value,s=!0;if(/^[A-Z][a-z]{2,19}$/.test(a)?$("#greskaIme").hide():($("#greskaIme").show(),s=!1),/^[A-Z][a-z]{2,19}(\s[A-Z][a-z]{2,19})*$/.test(i)?$("#greskaPrezime").hide():($("#greskaPrezime").show(),s=!1),/^[^@]+@[^@]+\.[^@\.]+$/.test(t)?$("#greskaEmail").hide():($("#greskaEmail").show(),s=!1),/^06\d{7,8}$/.test(o)?$("#greskaTelefon").hide():($("#greskaTelefon").show(),s=!1),/^[^@]+(\s[^@]+)*$/.test(n)?$("#greskaPoruka").hide():($("#greskaPoruka").show(),s=!1),0==r?($("#greskaRazlogKontakta").show(),s=!1):$("#greskaRazlogKontakta").hide(),s){r=["Prodaja","Isporuka robe","Reklamacije","Vaše primedbe i sugestije","Ostala pitanja"][r-1],$.ajax({url:"admin/mejl-insert.php",method:"post",dataType:"json",data:{btn:e,ime:a,prezime:i,email:t,telefon:o,razlogKontakta:r,poruka:n},success:function(e){let a="";e.forEach(e=>{a+=`<span>${e}</span><br/>`}),document.getElementById("poruka").innerHTML=a},error:function(e,a,i){let t="<ol>";e.responseJSON.forEach(e=>{t+=`<li class='crveno'>${e}</li>`}),t+="</ol>",document.getElementById("poruka").innerHTML=t}})}}function prikaziAnketu(){$.ajax({url:"admin/anketa-select.php",method:"post",dataType:"json",success:function(e){ispis="<form>",ispis+=`<h3>${e.anketa.pitanje}</h3> <input type="hidden" value="${e.anketa.idAnketa}" id="anketeRez"/>`,e.odgovori.forEach(e=>{ispis+=`<span><input type="radio" name="odgovori" value="${e.idOdgovor}">\n                <label>${e.odgovor}</label></span>`}),ispis+="<span id='greskaAnketa' class='greska'>Morate čekirati odgovor</span></form>",document.getElementById("rezultatiAnkete").innerHTML=ispis},error:function(e,a,i){console.log(e),alert(e.responseJSON)}})}function anketaInsert(){let e=$(this).val(),a=$("#pitanje"),i=$("#odgovori"),t=!0,o=/^[^@]+$/;o.test(a.val())?a.next().hide():(a.next().show(),t=!1),o.test(i.val())?i.next().hide():(i.next().show(),t=!1),t&&$.ajax({url:"admin/anketa.php",method:"post",dataType:"json",data:{btn:e,pitanje:a.val(),odgovori:i.val()},success:function(e){alert(e.poruka),location.reload()},error:function(e,a,i){let t="<ol>";e.responseJSON.forEach(e=>{t+=`<li class='crveno'>${e}</li>`}),t+="</ol>",document.getElementById("poruka").innerHTML=t}})}function aktivirajAnketu(){let e=$(this).val(),a=$("#anketeAktivacija"),i=!0;0==a.val()?(a.next().show(),i=!1):a.next().hide(),i&&$.ajax({url:"admin/anketa.php",method:"post",dataType:"json",data:{btn:e,idAnketa:a.val()},success:function(e){alert(e.poruka),location.reload()},error:function(e,a,i){alert(e.responseJSON)}})}function prikaziRezAnkete(){let e=$(this).val(),a=$("#anketeRez"),i=!0;0==a.val()?(a.next().show(),i=!1):a.next().hide(),i&&$.ajax({url:"admin/anketa.php",method:"post",dataType:"json",data:{btn:e,idAnketa:a.val()},success:function(e){let a="";console.log(e),e.rezultati.forEach(i=>{Number(i.broj)?a+=`<div><div class="col-8 mx-auto"><span>${i.odgovor}</span></div><div class="col-8 mx-auto progresDiv"><div class="progres flex" style="width:${parseInt(i.broj)/e.ukupno[0].ukupno*100}%;">${Math.round(parseInt(i.broj)/e.ukupno[0].ukupno*100,0)}%</div></div></div>`:a+=`<div><div class="col-8 mx-auto"><span>${i.odgovor}</span></div><div class="col-8 mx-auto progresDiv"><div class="progres flex" style="width:0%;">0%</div></div></div>`}),document.getElementById("rezultatiAnkete").innerHTML=a},error:function(e,a,i){alert(e.responseJSON)}})}function upisOdgovora(){let e=$(this).val(),a=$("input[type=radio][name=odgovori]:checked"),i=!0;0==a.length?($("#greskaAnketa").show(),i=!1):($("#greskaAnketa").hide(),idOdgovor=a.val()),i&&$.ajax({url:"admin/odgovor-insert.php",method:"post",dataType:"json",data:{idKorisnik:e,idOdgovor:idOdgovor},success:function(e){alert(e),location.reload()},error:function(e,a,i){console.log(e.responseJSON),alert(e.responseJSON)}})}